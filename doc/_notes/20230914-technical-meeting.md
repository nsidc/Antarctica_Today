# 2023-09-14 meeting with Liz, Mike, Walt

- The README in this repo is out of date. Liz has a newer one, will send. See
  e-mail!
- Code runs in steps. Liz wonders if `update_data.py` is meant to run them all
  in one. Based on notes below from Mike, maybe not?
  1.  Download all NSIDC-0080 faily granules using `nsidc_download_Tb_data.py`
      - For data before 2016, `NSIDC-0001` and `NSIDC-0007` are used.
  2.  Generate all the daily melt binary files using
      `generate_daily_melt_file.py`
      - Binaries provided in `data/daily_melt_bin_files` already calibrated by
        Tom Mote for pre 2016 dates.
  3.  Run the main script (`main.py`) with `--preprocess` flag. Creates
      climatologies, other things. May not need to be done every day.
  4.  Run the main script (`main.py`)
- Liz emailed a 2022 threshold file, need 2023 from Tom Mote for forward
  processing. Ted or Walt will reach out to Tom for this file.
- Liz thinks we can skip the preprocess step for these daily images. In fact,
  may only need to run `generate_antarctica_today_map.py`. She thinks line plots
  (`plot_current_year_melt_over_baseline_stats`) and maps can be generated with
  this code!
  - Mike: Generating daily files builds 4 things:
    - daily melt map
    - cumulative melt map (from Oct 1 to current day)
    - melt anomaly map (req. climatology)
    - line plot (req. climatology)
  - Mike: Climatology is initialized, which can take a long time, but after that
    it can be incrementally updated.
- Many parameters have defaults that Liz would like to extract to constants,
  e.g. `doy_start` and `doy_end`.
- Ted would often ask to have both full-extent and peninsula-only maps, would be
  nice if that was parameterized (pick a region-number; what about manual
  bbox?). Mike has already done this!
- One of the data files contains region definitions.
- At runtime, a giant pickle file is generating containing the full historical
  dataset (3d array)
  - Downloads full dataset from NSIDC.
  - `update_data.py` will update the pickle file every day with new data.
  - Other intermediate CSVs are generated.

## Liz experiences

- Liz never created the figures I'll need to create. The code I need to run
  should be in this repository. Where?
- Liz created a document for me, will send. See e-mail! They may be cryptic, ask
  her if I need more info. This document is about the plots _she_ created, which
  will be different than the ones I create.

## Mike background

- Wanted to automate things initially.
- Annual thresholds generated by model runs by Tom Mote. Code is on his machine,
  but nobody else has seen it. Close to retirement, no hand-off plan.
- He may be open to opening his models/code.
- Mostly IDL, Fortran, shell scripts. Built in 90s, has undergone many changes
  over decades.
- Tom may apply some personal expertise to subjectively adjust values.

## Scope of the work

Create daily images akin to Greenland Today. Runnable by ops.

- Maps
  - Cumulative melt: How many days experienced melt for each grid cell?
  - Daily melt: Which grid cells melted this day?
- Plot
  - Line plot: Total extent (`km^2`) of melt on a given day. Maybe % of total?
    Greenland Today uses `% of total ice sheet`, but this may not be suitable
    for Antarctica [Walt]. Maybe make it easy to do both.

## Questions

- Where to write the images?
-

## Repo plan

- [x] Migrate to NSIDC
- Notify Mike for PRs (set up in GitHub)
- [x] Document Mike as co-maintainer with NSIDC
- Loop Mike in for questions, could help with unit test cases

## TODO

- [x] Email Mike:
  - Shared repo for AT code
  - Mike will be admin, maintainer
  - Instructions for transferring repo
  - Instructions for GitHub notifications
- Mike uses Slack, consider invitation: `Michael.MacFerrin@colorado.edu`
